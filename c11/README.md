# c11

唔，虽然说不至于是一直在全力看吧，几乎大多数课余时间都在看这个，还是花了一周...

因为有blog了，所以多说正事。

TINY会因为收到RST报文后的ECONNRESET而崩溃，关于RST报文，我在TCP/IP详解中找到的解释是，会发生连接的快速拆卸，所以我选择的行为发现ECONNRESET后各种直接返回，实现的时候是修改了csapp.c中Rio包的函数的返回，因为读返回0即EOF也是应该关闭连接的，所以选择如果出错的原因是ECONNRESET就返回0。

类似的EPIPE在屏蔽了SIGPIPE之后可以有一样的处理办法，因为写已经关闭的连接导致的错误，把这边的套接字也关掉去下一轮就是了。即只要在屏蔽了SIGPIPE信号的情况下，做和ECONNRESET一样的处理即可。

关于POST部分，我实现了三种enctype...但是都是建立在所有的内容能一次被读进缓冲区的基础上做的，首先这一点就不好，不过也是考虑到cgiargs就那么大\(然后其中multipart/form-dada写的尤其臃肿，想重写但是感觉即使重写也差不太多...可能放进某个函数里面就舒服了。

不过修改的时候，我是觉得能不修改adder就最好了，所以把post形式的键值对都转化成了和get的情况下一样的形式。

验证的话，有一个adderpost.html，三个按钮有三种不同的formenctype属性。

虽然自己直接修改了csapp.c里面的Rio函数（但是其实应该自己重新封装一套网络用的rio函数的...算了，就这样吧（毕竟我的时间也不多了

